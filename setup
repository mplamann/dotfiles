#!/bin/bash

BASE="$(cd "$(dirname "${BASH_SOURCE[0]}" )" && pwd )"

link_config() {
  DIR=$1
  [[ -d ~/.config/$DIR ]] && echo "$1 config directory already exists" || ln -s "$(readlink -f $BASE/config/$1)" "$(readlink -f ~/.config/$1)"
}

# make a symlink at $2 that points to $1
# $2 should be out in filesystem somewhere
# $1 should be inside of dotfiles
link() {
  SOURCE="$(readlink -f $BASE/$1)"
  DEST="$(readlink -f $2)"
  [[ -e $DEST ]] && echo "$DEST already exists" || ln -s "$SOURCE" "$DEST"
}

link_config bspwm
link_config sxhkd

link scripts ~/scripts
link spacemacs ~/.spacemacs
link Xresources ~/.Xresources

GENERATED_BY="#generated by dotfiles setup, do not remove" 

setup_bash_profile() {
  echo "$GENERATED_BY" >> ~/.bash_profile
  echo "source $BASE/bash_config" >> ~/.bash_profile
}

grep -Fxq "$GENERATED_BY" ~/.bash_profile && echo ".bash_profile already set up" || setup_bash_profile
